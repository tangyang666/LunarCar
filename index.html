<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小区车牌号码查询</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .search-box {
            display: flex;
            margin: 20px 0;
        }
        input {
            flex: 1;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 4px 0 0 4px;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
            display: none;
        }
        .match {
            color: #2196F3;
            font-weight: bold;
        }
        .no-match {
            color: #F44336;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        @media (max-width: 768px) {
            .search-box {
                flex-direction: column;
            }
            input {
                border-radius: 4px;
                margin-bottom: 10px;
            }
            button {
                border-radius: 4px;
                width: 100%;
            }
            table {
                font-size: 14px;
            }
            th, td {
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>小区车牌号码查询</h1>
        <p style="text-align: center; color: #666; margin-bottom: 20px;">
            输入完整或部分车牌号进行查询，支持模糊匹配（例如：输入"粤B66666"可以匹配"粤B6**66"）
        </p>
        <div class="search-box">
            <input type="text" id="plateInput" placeholder="请输入车牌号，例如：粤B66666">
            <button onclick="searchPlate()">查询</button>
        </div>
        <div id="result"></div>
    </div>
    
    <footer style="text-align: center; margin-top: 30px; color: #999; font-size: 14px;">
        <p>© 2025 小区车牌号码查询系统 | 仅供小区内部使用</p>
    </footer>

    <script>
        // 车牌数据数组
        const plateData = [
            { id: 1, plate: "粤B0**B9", remark: "A0501" },
            { id: 2, plate: "粤B8**DP", remark: "A0503" },
            { id: 3, plate: "粤B4**R8", remark: "A0506" },
            { id: 4, plate: "粤B2**P7", remark: "A0509" },
            { id: 5, plate: "粤B0**L0", remark: "A0610" },
            { id: 6, plate: "粤BF0**58", remark: "A0904" },
            { id: 7, plate: "粤BV**6L", remark: "A0906" },
            { id: 8, plate: "粤B6**Z6", remark: "A0909" },
            { id: 9, plate: "粤B8**65", remark: "A1002" },
            { id: 10, plate: "粤B7**F7", remark: "A1005" },
            { id: 11, plate: "粤BGX**25", remark: "A1103" },
            { id: 12, plate: "粤BR**S6", remark: "A1201" },
            { id: 13, plate: "粤BH**4M", remark: "A1202" },
            { id: 14, plate: "粤B0**C8", remark: "A1208" },
            { id: 15, plate: "粤B5**0X", remark: "A1209" },
            { id: 16, plate: "粤B5**38", remark: "A1301" },
            { id: 17, plate: "粤B1**G7", remark: "A1307" },
            { id: 18, plate: "粤B7**N3", remark: "A1402" },
            { id: 19, plate: "粤B3**0K", remark: "A1403" },
            { id: 20, plate: "粤BM**51", remark: "A1409" },
            { id: 21, plate: "粤BF0**35", remark: "A1505" },
            { id: 22, plate: "粤B7**7S", remark: "A1508" },
            { id: 23, plate: "粤BR**2G", remark: "A1601" },
            { id: 24, plate: "粤B1**52", remark: "A1604" },
            { id: 25, plate: "粤B1**76", remark: "A1701" },
            { id: 26, plate: "粤B9**50", remark: "A1706" },
            { id: 27, plate: "粤B0**1L", remark: "A1709" },
            { id: 28, plate: "粤B0**8D", remark: "A1801" },
            { id: 29, plate: "粤B5**M7", remark: "A1808" },
            { id: 30, plate: "粤BT**L2", remark: "A1809" },
            { id: 31, plate: "粤B6**7H", remark: "A1901" },
            { id: 32, plate: "粤B1**7E", remark: "A1902" },
            { id: 33, plate: "粤BD1**73", remark: "A1906" },
            { id: 34, plate: "粤B9**18", remark: "A2005" },
            { id: 35, plate: "粤B0**Y0", remark: "A2102" },
            { id: 36, plate: "粤B6**17", remark: "A2106" },
            { id: 37, plate: "粤B7**E8", remark: "A2109" },
            { id: 38, plate: "粤B9**FY", remark: "A2202" },
            { id: 39, plate: "粤BAL**96", remark: "A2302" },
            { id: 40, plate: "粤BU**4F", remark: "A2403" },
            { id: 41, plate: "粤B9**GU", remark: "A2405" },
            { id: 42, plate: "粤B1**E6", remark: "A2509" },
            { id: 43, plate: "粤B9**S8", remark: "A2601" },
            { id: 44, plate: "粤BV**G5", remark: "A2706" },
            { id: 45, plate: "粤BQ**H5", remark: "A2710" },
            { id: 46, plate: "粤B3**77", remark: "A2802" },
            { id: 47, plate: "粤B2**2K", remark: "A2802" },
            { id: 48, plate: "BAT**76", remark: "A2804" },
            { id: 49, plate: "粤B6**X1", remark: "A2810" },
            { id: 50, plate: "粤B0**8D", remark: "A2901" },
            { id: 51, plate: "粤BP**6V", remark: "A2906" },
            { id: 52, plate: "粤B1**L1", remark: "A3003" },
            { id: 53, plate: "粤BU**2V", remark: "A3006" },
            { id: 54, plate: "粤BB**76", remark: "A3101" },
            { id: 55, plate: "粤BJ**93", remark: "A3103" },
            { id: 56, plate: "粤B1**Z8", remark: "A3106" },
            { id: 57, plate: "粤BH**9B", remark: "B0509" },
            { id: 58, plate: "粤B6**36", remark: "B0510" },
            { id: 59, plate: "粤BT**5B", remark: "B0608" },
            { id: 60, plate: "粤B0**Q5", remark: "B0610" },
            { id: 61, plate: "粤B1***A0", remark: "B0702" },
            { id: 62, plate: "粤B3**J5", remark: "B0807" },
            { id: 63, plate: "苏E3***T3", remark: "B0904" },
            { id: 64, plate: "粤B7**50", remark: "B0907" },
            { id: 65, plate: "粤BE**E1", remark: "B1004" },
            { id: 66, plate: "粤B1**3L", remark: "B1103" },
            { id: 67, plate: "粤BM**09", remark: "B1107" },
            { id: 68, plate: "粤B1**8F", remark: "B1306" },
            { id: 69, plate: "粤B0**VW", remark: "B1407" },
            { id: 70, plate: "粤B4**D8", remark: "B1410" },
            { id: 71, plate: "粤B9**B9", remark: "B1502" },
            { id: 72, plate: "粤B6**SP", remark: "B1508" },
            { id: 73, plate: "粤BFT**16", remark: "B1808" },
            { id: 74, plate: "粤BD6**76", remark: "B1903" },
            { id: 75, plate: "粤BR**7H", remark: "B1907" },
            { id: 76, plate: "粤B9**MH", remark: "B1908" },
            { id: 77, plate: "粤B4**QC", remark: "B2001" },
            { id: 78, plate: "粤B3**V7", remark: "B2005" },
            { id: 79, plate: "粤BA**34", remark: "B2008" },
            { id: 80, plate: "粤GG**27", remark: "B2110" },
            { id: 81, plate: "粤BD**7X", remark: "B2301" },
            { id: 82, plate: "粤BW**31", remark: "B2307" },
            { id: 83, plate: "粤B2**08", remark: "B2402" },
            { id: 84, plate: "粤BX**U6", remark: "B2602" },
            { id: 85, plate: "粤B8**DA", remark: "B2602" },
            { id: 86, plate: "粤B6**85", remark: "B2608" },
            { id: 87, plate: "粤B1**L5", remark: "B2609" },
            { id: 88, plate: "粤B9**5Q", remark: "B2707" },
            { id: 89, plate: "粤B8**A0", remark: "B2707" },
            { id: 90, plate: "粤BP**1T", remark: "B2801" },
            { id: 91, plate: "粤B7**Y8", remark: "B2807" },
            { id: 92, plate: "粤PX**58", remark: "B2905" },
            { id: 93, plate: "粤B0**A9", remark: "B2908" },
            { id: 94, plate: "粤BG**60", remark: "B3006" },
            { id: 95, plate: "粤B5**4U", remark: "B3007" },
            { id: 96, plate: "粤B2**7V", remark: "B3008" },
            { id: 97, plate: "粤B2**Y6", remark: "B3010" },
            { id: 98, plate: "粤BF6**51", remark: "B3108" },
            { id: 99, plate: "粤BE**19", remark: "B3109" },
            { id: 100, plate: "粤BF9**98", remark: "C0504" },
            { id: 101, plate: "粤B8**8N", remark: "C0605" },
            { id: 102, plate: "粤BDM**05", remark: "C0701" },
            { id: 103, plate: "粤BD**4D", remark: "C0705" },
            { id: 104, plate: "粤BF1**33", remark: "C0806" },
            { id: 105, plate: "粤B1**AW", remark: "C0809" },
            { id: 106, plate: "粤B2**6J", remark: "C0904" },
            { id: 107, plate: "粤BF8**10", remark: "C0910" },
            { id: 108, plate: "粤B9**JD", remark: "C1001" },
            { id: 109, plate: "粤B1**X2", remark: "C1003" },
            { id: 110, plate: "粤BE**C2", remark: "C1105" },
            { id: 111, plate: "粤BM**9N", remark: "C1202" },
            { id: 112, plate: "粤B4**00", remark: "C1202" },
            { id: 113, plate: "粤B7***KQ", remark: "C1301" },
            { id: 114, plate: "粤B6**T6", remark: "C1305" },
            { id: 115, plate: "粤BF0**13", remark: "C1503" },
            { id: 116, plate: "粤B5**Z1", remark: "C1504" },
            { id: 117, plate: "粤B5**1S", remark: "C1508" },
            { id: 118, plate: "粤BF1**50", remark: "C1601" },
            { id: 119, plate: "粤B1**6C", remark: "C1709" },
            { id: 120, plate: "粤BG**U8", remark: "C1801" },
            { id: 121, plate: "粤B6**U8", remark: "C1901" },
            { id: 122, plate: "粤BP**23", remark: "C1902" },
            { id: 123, plate: "粤BK**H6", remark: "C1903" },
            { id: 124, plate: "粤B8**L3", remark: "C2003" },
            { id: 125, plate: "津DD**37", remark: "C2006" },
            { id: 126, plate: "粤B1**QZ", remark: "C2106" },
            { id: 127, plate: "粤B1**V1", remark: "C2202" },
            { id: 128, plate: "粤L2**19", remark: "C2203" },
            { id: 129, plate: "粤B9**9B", remark: "C2304" },
            { id: 130, plate: "粤B8**W8", remark: "C2401" },
            { id: 131, plate: "粤B0**3M", remark: "C2502" },
            { id: 132, plate: "粤B0**96", remark: "C2510" },
            { id: 133, plate: "粤BZ**0M", remark: "C2602" },
            { id: 134, plate: "粤BFA**87", remark: "C2701" },
            { id: 135, plate: "粤B8**TC", remark: "C2710" },
            { id: 136, plate: "粤B3**HV", remark: "C2801" },
            { id: 137, plate: "粤BK**J1", remark: "C2901" },
            { id: 138, plate: "粤B6**GN", remark: "C2906" },
            { id: 139, plate: "粤B1**8J", remark: "C2907" },
            { id: 140, plate: "粤BFG**68", remark: "C2908" },
            { id: 141, plate: "粤B2**JQ", remark: "C3002" }
        ];

        function searchPlate() {
            const input = document.getElementById('plateInput').value.trim();
            const resultDiv = document.getElementById('result');
            
            if (!input) {
                resultDiv.innerHTML = '<p class="no-match">请输入车牌号</p>';
                resultDiv.style.display = 'block';
                return;
            }
            
            // 创建模糊匹配模式
            const matches = [];
            
            for (const item of plateData) {
                if (isFuzzyMatch(input, item.plate)) {
                    matches.push(item);
                }
            }
            
            if (matches.length > 0) {
                let html = `<p class="match">找到 ${matches.length} 条匹配结果：</p>`;
                html += '<table><tr><th>序号</th><th>车牌号</th><th>房号</th></tr>';
                
                matches.forEach(match => {
                    html += `<tr><td>${match.id}</td><td>${match.plate}</td><td>${match.remark}</td></tr>`;
                });
                
                html += '</table>';
                resultDiv.innerHTML = html;
            } else {
                resultDiv.innerHTML = '<p class="no-match">未找到匹配的车牌号</p>';
            }
            
            resultDiv.style.display = 'block';
        }
        
        function isFuzzyMatch(input, plateNumber) {
            // 转换为小写进行比较
            const inputLower = input.toLowerCase();
            const plateLower = plateNumber.toLowerCase();
            
            // 精确匹配
            if (plateLower === inputLower) {
                return true;
            }
            
            // 部分匹配 - 输入是车牌的子串
            if (plateLower.includes(inputLower)) {
                return true;
            }
            
            // 输入是车牌的前缀
            if (plateLower.startsWith(inputLower)) {
                return true;
            }

            // 处理数据库中带星号的情况（如粤BR**7H）
            if (plateLower.includes('*')) {
                // 将带星号的车牌转换为正则表达式
                const plateRegexStr = plateLower.replace(/\*/g, '.');
                const plateRegex = new RegExp('^' + plateRegexStr + '$');
                
                // 检查输入是否匹配该正则表达式
                if (plateRegex.test(inputLower)) {
                    return true;
                }
                
                // 创建不带星号的车牌版本用于部分匹配
                const plateWithoutStars = plateLower.split('*').join('');
                
                // 将带星号的车牌转换为正则表达式模式
                // 例如：粤B6**X1 转换为 粤B6.*X1
                const plateSegments = plateLower.split('*');
                let regexPattern = '';
                for (let i = 0; i < plateSegments.length; i++) {
                    regexPattern += plateSegments[i];
                    if (i < plateSegments.length - 1) {
                        regexPattern += '.*?'; // 非贪婪匹配
                    }
                }
                const advancedRegex = new RegExp('^' + regexPattern + '$');
                if (advancedRegex.test(inputLower)) {
                    return true;
                }
                
                // 特殊匹配 - 检查输入中是否包含了车牌中除星号外的所有字符，且顺序一致
                let inputIndex = 0;
                let allCharsFound = true;
                
                for (let i = 0; i < plateWithoutStars.length; i++) {
                    const char = plateWithoutStars[i];
                    let charFound = false;
                    
                    // 从当前输入索引开始查找
                    while (inputIndex < inputLower.length) {
                        if (inputLower[inputIndex] === char) {
                            charFound = true;
                            inputIndex++;
                            break;
                        }
                        inputIndex++;
                    }
                    
                    if (!charFound) {
                        allCharsFound = false;
                        break;
                    }
                }
                
                if (allCharsFound && inputIndex <= inputLower.length) {
                    return true;
                }
                
                // 尝试更智能的匹配算法
                // 将车牌号按星号分段，然后逐段比较
                const plateSegmentsForMatch = plateLower.split('*');
                
                // 如果车牌只包含一个段（没有星号），则不适用此算法
                if (plateSegmentsForMatch.length > 1) {
                    // 检查第一段是否匹配（必须从开头匹配）
                    if (!inputLower.startsWith(plateSegmentsForMatch[0])) {
                        return false;
                    }
                    
                    // 检查最后一段是否匹配（必须匹配到结尾）
                    if (!inputLower.endsWith(plateSegmentsForMatch[plateSegmentsForMatch.length - 1])) {
                        return false;
                    }
                    
                    // 遍历中间段落，检查它们是否按顺序出现
                    let currentPos = plateSegmentsForMatch[0].length;
                    
                    for (let i = 1; i < plateSegmentsForMatch.length - 1; i++) {
                        const segment = plateSegmentsForMatch[i];
                        if (segment.length === 0) continue; // 跳过空段
                        
                        const segmentPos = inputLower.indexOf(segment, currentPos);
                        if (segmentPos === -1) {
                            return false; // 没找到这个段
                        }
                        
                        currentPos = segmentPos + segment.length;
                    }
                    
                    // 如果所有段都按顺序找到，则匹配成功
                    return true;
                }
            }
            
            // 处理输入中带星号的情况（用户输入了模糊查询）
            if (inputLower.includes('*') || inputLower.includes('?')) {
                const inputRegexStr = inputLower
                    .replace(/\*/g, '.')  // 将*转换为正则表达式中的.（匹配任意字符）
                    .replace(/\?/g, '.'); // 将?转换为正则表达式中的.
                    
                const inputRegex = new RegExp('^' + inputRegexStr + '$');
                return inputRegex.test(plateLower);
            }
            
            // 特殊场景: 判断车牌号中的非星号字符是否都在输入中出现过，且顺序一致
            // 例如：粤BRIQ7H 应该匹配 粤BR**7H
            if (plateLower.includes('*')) {
                const plateChars = plateLower.split('');
                let inputChars = inputLower.split('');
                let lastMatchedIndex = -1;
                let matchCount = 0;
                
                for (let i = 0; i < plateChars.length; i++) {
                    if (plateChars[i] === '*') {
                        continue; // 跳过星号
                    }
                    
                    // 在输入中查找当前字符，从上一个匹配位置之后开始
                    for (let j = lastMatchedIndex + 1; j < inputChars.length; j++) {
                        if (inputChars[j] === plateChars[i]) {
                            lastMatchedIndex = j;
                            matchCount++;
                            break;
                        }
                    }
                }
                
                // 如果匹配的字符数与车牌中非星号字符数相同，则认为匹配成功
                const nonStarCharsCount = plateChars.filter(c => c !== '*').length;
                if (matchCount === nonStarCharsCount) {
                    return true;
                }
            }
            
            return false;
        }
        
        // 监听回车键
        document.getElementById('plateInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchPlate();
            }
        });
    </script>
</body>
</html> 